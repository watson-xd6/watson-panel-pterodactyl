<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Your Panel</title>
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/izitoast/dist/css/iziToast.min.css">
</head>
<body>
<div class="main-container">
    <div class="panel-box">
        <h2>Your Panels</h2>
        <div id="panelListContainer">Loading...</div>
        <a href="create-panel.html" class="btn-secondary">Create New Panel</a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/izitoast/dist/js/iziToast.min.js"></script>
<script>
const username = localStorage.getItem('username');
if (!username) {
    iziToast.error({ title: 'Error', message: 'Please login first.' });
    setTimeout(() => { window.location.href = 'login.html'; }, 1500);
}

async function loadPanels() {
    try {
        const response = await fetch('/api/get-panels', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username })
        });
        const panels = await response.json();
        const container = document.getElementById('panelListContainer');
        if (!panels || panels.length === 0) {
            container.innerHTML = "<p>No panels created yet.</p>";
            return;
        }
        container.innerHTML = panels.map(p => `
            <div class="data-item">
                <strong>${p.server_name}</strong><br>
                Username: ${p.username}<br>
                Plan: ${p.plan}<br>
                Created At: ${p.createdAt}
            </div>
        `).join('');
    } catch (err) {
        console.error(err);
    }
}

loadPanels();
</script>
</body>
</html>
